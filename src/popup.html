<!DOCTYPE html>
<html>
<head>
  <title>Smart Download Organizer</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="main-interface">
    <div class="header">
      <h2>Smart Download Organizer</h2>
      <div class="header-buttons">
        <button id="theme-toggle" class="theme-toggle"></button>
        <button id="show-help" class="help-button">?</button>
      </div>
    </div>

    <div class="warning">
      IMPORTANT: Currently, only folders on the SAME DRIVE as your default download folder are supported.
    </div>

    <div id="configs-container"></div>
    
    <div class="footer">
      <button id="add-config" class="btn add-btn">Add New Configuration</button>
      <button id="llm-settings-btn" class="btn llm-btn">LLM Settings</button>
      <button id="save-configs" class="btn save-btn">Save Settings</button>
    </div>
  </div>

  <div id="llm-interface" style="display: none;">
    <div class="header">
        <h2>LLM Settings</h2>
    </div>
    <div class="llm-section">
        <div class="config-header">
            <h3 class="config-title">Enable LLM-based Sorting</h3>
            <div class="toggle-container">
                <label class="toggle-switch">
                    <input type="checkbox" id="llm-enabled-toggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
        <div class="config-content">
            <div class="form-group">
                <label for="llm-api-url">API URL:</label>
                <input type="text" id="llm-api-url" placeholder="e.g., https://api.groq.com/openai/v1/chat/completions">
            </div>
            <div class="form-group">
                <label for="llm-api-key">API Key:</label>
                <input type="text" id="llm-api-key" placeholder="Enter your API key">
            </div>
            <div class="form-group">
                <label for="llm-model">Model:</label>
                <input type="text" id="llm-model" placeholder="e.g., llama3-8b-8192">
            </div>
        </div>
    </div>
    <div class="footer">
        <button id="back-to-main-btn" class="btn add-btn">Back</button>
        <button id="save-llm-settings-btn" class="btn save-btn">Save LLM Settings</button>
    </div>
  </div>

  <div id="help-section" class="help-section">
    <h2>How to Use This Extension</h2>
    <h3>Quick Start</h3>
    <p>This extension automatically redirects downloads to specific folders based on the keywords and criteria you define. Sorting is done automatically.</p>
    <h3>Setting Up Custom Folders</h3>
    <ol>
      <li>Click "Add New Configuration" to create a new rule.</li>
      <li>Enter a descriptive name for this rule (e.g., "Minecraft Mods", "Blender Assets", "Design Documents").</li>
      <li>Set the download path where matching downloads should be saved (e.g., <code>E:\Games\.Minecraft\mods\</code>). <strong style="color: red;">Important: Ensure this path is on the SAME DRIVE as your default download folder.</strong></li>
      <li>Click "Save Settings" to apply your changes.</li>
    </ol>
    <h3>Configuring Keywords</h3>
    <p>Keywords help the extension identify where a download should be saved. They are used in "Classic Mode" and also help guide the "LLM Mode".</p>
    <h3>How Matching Works</h3>
    <p>You can choose between two modes in the settings:</p>
    <ol>
      <li><strong>Classic Mode (Default):</strong> Uses a score-based system on filename, page title, URL, and page content to find keyword matches.</li>
      <li><strong>LLM Mode (Advanced):</strong> Sends the filename, recent URLs, and page titles to an AI model (like GPT or Llama) for a smart decision. This requires setting up an API key in the "LLM Settings".</li>
    </ol>
    <h3>Troubleshooting</h3>
    <p><strong>Downloads not redirecting?</strong></p>
    <ul>
      <li>Make sure your download paths are valid and end with a slash (<code>\</code> or <code>/</code>).</li>
      <li>In Classic Mode, add more specific keywords.</li>
      <li>In LLM Mode, ensure your API Key and URL are correct in the settings. Check the extension's Service Worker console for errors.</li>
    </ul>
    <h3>Tips</h3>
    <ul>
      <li><b>Pro Tip: Avoid using generalized words that are commonly found on websites, such as "its", "car", or other common nouns.</b></li>
      <li><b>Pro Tip: NEVER use the same keyword in different configurations.</b></li>
    </ul>
    This project will be open source forever, you are free to check it out more on <a href="https://github.com/gusta01010/Smart-Download-Organizer">https://github.com/gusta01010/Smart-Download-Organizer</a><br>Also a big credit to Pixel perfect for the extension icon: <a href="https://www.flaticon.com/free-icons/download" title="download icons">Download icons created by Pixel perfect - Flaticon</a><br>
    <button id="back-to-settings" class="back-to-settings">Back to Settings</button>
  </div>

  <script src="popup.js"></script>
</body>
</html>